"""
CyberQalqan AI โ Cyber Security Advisor (Knowledge-Based Chat)
Answers cybersecurity questions using a built-in knowledge base.
No API keys required โ all knowledge is embedded in code.
"""

import re
from typing import Dict, List, Tuple, Optional


# โโโ Knowledge Base โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

KNOWLEDGE_BASE = [
    {
        "id": "instagram_protect",
        "keywords": ["instagram", "ะธะฝััะฐะณัะฐะผ", "ะธะฝััะฐ", "ะฐะบะบะฐัะฝั าะพัาะฐั", "instagram าะพัาะฐั", "ะธะฝััะฐะณัะฐะผะดั าะพัาะฐั"],
        "question_patterns": ["ะธะฝััะฐะณัะฐะผ.*าะพัาะฐ", "instagram.*protect", "ะธะฝััะฐะณัะฐะผ.*าะฐััะฟััะท", "instagram.*ะฑะตะทะพะฟะฐั", "ะธะฝััะฐ.*hack", "ะธะฝััะฐ.*ะฑาฑะท"],
        "answer": {
            "kz": "๐ก๏ธ **Instagram ะฐะบะบะฐัะฝััาฃัะทะดั าะพัาะฐั ะถะพะปะดะฐัั:**\n\n1๏ธโฃ **ะะบั ัะฐะบัะพัะปั ะฐััะตะฝัะธัะธะบะฐัะธั (2FA) าะพััาฃัะท:**\n   โ ะะฐัะฐะผะตััะปะตั โ าะฐััะฟััะทะดัะบ โ ะะบั ัะฐะบัะพัะปั ะฐััะตะฝัะธัะธะบะฐัะธั โ SMS ะฝะตะผะตัะต Authenticator าะพััาฃัะท\n\n2๏ธโฃ **ะาฏัะดะตะปั ะฟะฐัะพะปั าะพะปะดะฐะฝัาฃัะท:**\n   โ ะะตะผัะฝะดะต 12 ัะธะผะฒะพะป: ะฑะฐั/ะบััั ำััะฟัะตั + ัะฐะฝะดะฐั + ะฐัะฝะฐะนั ะฑะตะปะณัะปะตั\n   โ ะััะฐะปั: `Kz_M3n1n_P@r0l!`\n   โ ะะฐัาะฐ ัะฐะนััะฐัะดะฐาั ะฟะฐัะพะปัะดั าะฐะนัะฐะปะฐะผะฐาฃัะท!\n\n3๏ธโฃ **ะะตะนัะฐะฝัั ััะปัะตะผะตะปะตัะณะต ะะะกะะาขะซะ:**\n   โ DM ะฐัาัะปั ะบะตะปะณะตะฝ ััะปัะตะผะตะปะตัะดั ะฐัะฟะฐาฃัะท\n   โ ยซะกัะท าฑััะฟ ะฐะปะดัาฃัะทยป ะดะตะณะตะฝ ัะฐะฑะฐัะปะฐะผะฐะปะฐัาะฐ ัะตะฝะฑะตาฃัะท\n\n4๏ธโฃ **ะััั ะฑะตะปัะตะฝะดัะปัะณัะฝ ัะตะบัะตััาฃัะท:**\n   โ ะะฐัะฐะผะตััะปะตั โ าะฐััะฟััะทะดัะบ โ ะััั ะฑะตะปัะตะฝะดัะปัะณั\n   โ ะะตะนัะฐะฝัั าาฑััะปาัะปะฐัะดั ััาะฐััาฃัะท\n\n5๏ธโฃ **าฎััะฝัั ัะฐัะฐะฟ าะพััะผัะฐะปะฐััะฝ ัะตะบัะตััาฃัะท:**\n   โ ะะฐัะฐะผะตััะปะตั โ าะฐััะฟััะทะดัะบ โ าะพััะผัะฐะปะฐั ะผะตะฝ ะฒะตะฑ-ัะฐะนััะฐั\n   โ าะฐะถะตัััะทะดะตััะฝ ะถะพะนัาฃัะท",
            "ru": "๐ก๏ธ **ะะฐะบ ะทะฐัะธัะธัั ะฐะบะบะฐัะฝั Instagram:**\n\n1๏ธโฃ **ะะบะปััะธัะต ะดะฒัััะฐะบัะพัะฝัั ะฐััะตะฝัะธัะธะบะฐัะธั (2FA):**\n   โ ะะฐัััะพะนะบะธ โ ะะตะทะพะฟะฐัะฝะพััั โ ะะฒัััะฐะบัะพัะฝะฐั โ SMS ะธะปะธ Authenticator\n\n2๏ธโฃ **ะัะฟะพะปัะทัะนัะต ัะปะพะถะฝัะน ะฟะฐัะพะปั:**\n   โ ะะธะฝะธะผัะผ 12 ัะธะผะฒะพะปะพะฒ: ะฑัะบะฒั + ัะธััั + ัะฟะตััะธะผะฒะพะปั\n   โ ะะต ะธัะฟะพะปัะทัะนัะต ะพะดะธะฝ ะฟะฐัะพะปั ะฝะฐ ัะฐะทะฝัั ัะฐะนัะฐั!\n\n3๏ธโฃ **ะะต ะฟะตัะตัะพะดะธัะต ะฟะพ ะฟะพะดะพะทัะธัะตะปัะฝัะผ ัััะปะบะฐะผ:**\n   โ ะะต ะพัะบััะฒะฐะนัะต ัััะปะบะธ ะฒ DM ะพั ะฝะตะทะฝะฐะบะพะผัะตะฒ\n   โ ะะต ะฒะตัััะต ัะพะพะฑัะตะฝะธัะผ ยซะั ะฒัะธะณัะฐะปะธยป\n\n4๏ธโฃ **ะัะพะฒะตััะนัะต ะฐะบัะธะฒะฝะพััั ะฒัะพะดะพะฒ:**\n   โ ะะฐัััะพะนะบะธ โ ะะตะทะพะฟะฐัะฝะพััั โ ะะบัะธะฒะฝะพััั ะฒัะพะดะฐ\n\n5๏ธโฃ **ะฃะดะฐะปะธัะต ะฝะตะฝัะถะฝัะต ััะพัะพะฝะฝะธะต ะฟัะธะปะพะถะตะฝะธั:**\n   โ ะะฐัััะพะนะบะธ โ ะะตะทะพะฟะฐัะฝะพััั โ ะัะธะปะพะถะตะฝะธั ะธ ัะฐะนัั",
            "en": "๐ก๏ธ **How to protect your Instagram account:**\n\n1๏ธโฃ **Enable Two-Factor Authentication (2FA)**\n2๏ธโฃ **Use a strong password** (12+ characters)\n3๏ธโฃ **Don't click suspicious links in DMs**\n4๏ธโฃ **Check login activity regularly**\n5๏ธโฃ **Remove unnecessary third-party apps**"
        }
    },
    {
        "id": "password_security",
        "keywords": ["ะฟะฐัะพะปั", "าาฑะฟะธััำฉะท", "password", "ะฟะฐัะพะป", "าาฑะฟะธั ัำฉะท", "ะฟะฐัะพะปั าะพั", "ัะตะฝัะผะดั ะฟะฐัะพะปั"],
        "question_patterns": ["ะฟะฐัะพะปั.*าะฐะปะฐะน", "าาฑะฟะธััำฉะท.*าะพัาะฐ", "password.*strong", "ะฟะฐัะพะปั.*ะฝะฐะดะตะถ", "ะฟะฐัะพะปั.*ัะตะฝัะผะดั", "าาฑะฟะธััำฉะท.*ะถะฐัะฐั"],
        "answer": {
            "kz": "๐ **ะกะตะฝัะผะดั าาฑะฟะธััำฉะท ะถะฐัะฐั:**\n\nโ **ะาฑััั ะฟะฐัะพะปั:**\n   โ ะะตะผัะฝะดะต 12 ัะธะผะฒะพะป\n   โ ะะฐั ะถำะฝะต ะบััั ำััะฟัะตั: `AaBbCc`\n   โ ะกะฐะฝะดะฐั: `123`\n   โ ะัะฝะฐะนั ะฑะตะปะณัะปะตั: `!@#$%`\n   โ ะััะฐะปั: `K@sp1_Kz_2025!`\n\nโ **าะพะปะดะฐะฝะฑะฐาฃัะท:**\n   โ ะขัาะฐะฝ ะบาฏะฝัาฃัะท: `01012000`\n   โ ะขะตะปะตัะพะฝ ะฝำฉะผัั: `87071234567`\n   โ าะฐัะฐะฟะฐะนัะผ ัำฉะทะดะตั: `qwerty`, `123456`\n   โ ะัั-ะถำฉะฝัาฃัะท: `Aidar2005`\n\n๐ก **ะะตาฃะตััะตั:**\n   โ ำั ัะฐะนัาะฐ ะำจะะะ ะฟะฐัะพะปั าะพะปะดะฐะฝัาฃัะท\n   โ ะะฐัะพะปั ะผะตะฝะตะดะถะตั าะพะปะดะฐะฝัาฃัะท (Bitwarden โ ัะตะณัะฝ)\n   โ ะะฐัะพะปัะดั 3 ะฐะนะดะฐ 1 ัะตั ะฐัััััััาฃัะท\n   โ ะัะบัะผะณะต ะฐะนัะฟะฐาฃัะท!",
            "ru": "๐ **ะะฐะบ ัะพะทะดะฐัั ะฝะฐะดัะถะฝัะน ะฟะฐัะพะปั:**\n\nโ **ะัะฐะฒะธะปัะฝัะน ะฟะฐัะพะปั:**\n   โ ะะธะฝะธะผัะผ 12 ัะธะผะฒะพะปะพะฒ\n   โ ะะฐะณะปะฐะฒะฝัะต ะธ ัััะพัะฝัะต ะฑัะบะฒั\n   โ ะฆะธััั ะธ ัะฟะตััะธะผะฒะพะปั: `!@#$%`\n\nโ **ะะต ะธัะฟะพะปัะทัะนัะต:**\n   โ ะะฐัั ัะพะถะดะตะฝะธั, ะฝะพะผะตั ัะตะปะตัะพะฝะฐ\n   โ ะัะพัััะต ัะปะพะฒะฐ: `qwerty`, `123456`\n\n๐ก **ะกะพะฒะตัั:**\n   โ ะะฐะทะฝัะน ะฟะฐัะพะปั ะดะปั ะบะฐะถะดะพะณะพ ัะฐะนัะฐ\n   โ ะัะฟะพะปัะทัะนัะต ะผะตะฝะตะดะถะตั ะฟะฐัะพะปะตะน (Bitwarden)\n   โ ะะตะฝัะนัะต ะฟะฐัะพะปั ะบะฐะถะดัะต 3 ะผะตัััะฐ",
            "en": "๐ **Creating a strong password:**\n\nโ At least 12 characters with uppercase, lowercase, numbers, symbols\nโ Don't use birthdays, phone numbers, or simple words\n๐ก Use a password manager like Bitwarden"
        }
    },
    {
        "id": "phone_hacked",
        "keywords": ["ัะตะปะตัะพะฝ", "ะฑาฑะทัะปะดั", "ะฑาฑะทัะปาะฐะฝ", "ะฒะทะปะพะผะฐะปะธ", "hack", "ัะฐะบะตั", "ะฒะธััั", "ะทะธัะฝะดั", "ัะตะปะตัะพะฝ ะฑาฑะท", "ัะผะฐัััะพะฝ"],
        "question_patterns": ["ัะตะปะตัะพะฝ.*ะฑาฑะท", "ัะตะปะตัะพะฝ.*ะฒะธััั", "ัะตะปะตัะพะฝ.*hack", "ะฒะทะปะพะผะฐะปะธ.*ัะตะปะตัะพะฝ", "phone.*hack", "ัะตะปะตัะพะฝ.*าะฐััะฟััะท", "ัะผะฐัััะพะฝ.*าะพัาะฐ"],
        "answer": {
            "kz": "๐ฑ **ะขะตะปะตัะพะฝัาฃัะท ะฑาฑะทัะปะดั ะผะฐ? ะขะตะบัะตัั ะถะพะปะดะฐัั:**\n\n๐ **ะาฑะทัะปั ะฑะตะปะณัะปะตัั:**\n   โ ะะฐัะฐัะตั ัะตะท ะพัััะฐะดั\n   โ ะะตะปะณัััะท าะพััะผัะฐะปะฐั ะฟะฐะนะดะฐ ะฑะพะปะดั\n   โ ะขะตะปะตัะพะฝ ะฑะฐัั ะถาฑะผัั ัััะตะนะดั\n   โ ะะฝัะตัะฝะตั-ััะฐัะธะบ ะบำฉะฑะตะนะดั\n   โ ำจะทะดัะณัะฝะตะฝ SMS ะถัะฑะตััะปะตะดั\n   โ ะะฐัะฝะฐะผะฐ าะฐะปาัะผะฐะปะฐั ััาะฐะดั\n\n๐๏ธ **ะะต ัััะตั ะบะตัะตะบ:**\n   1. Wi-Fi ะผะตะฝ ะผะพะฑะฐะนะป ะดะตัะตะบัั ำฉััััาฃัะท\n   2. ะะตะปะณัััะท าะพััะผัะฐะปะฐัะดั ะถะพะนัาฃัะท\n   3. ะะฝัะธะฒะธััั ะพัะฝะฐััาฃัะท (Kaspersky, Dr.Web)\n   4. ะะฐัะปัา ะฟะฐัะพะปัะดะตัะดั ะฐัััััััาฃัะท\n   5. ะะฐะฝะบ าะพััะผัะฐะปะฐััะฝ ัะตะบัะตััาฃัะท\n   6. าะธัะฝ ะถะฐาะดะฐะนะดะฐ โ ะทะฐัััััา ะฟะฐัะฐะผะตััะปะตัะณะต าะฐะนัะฐััาฃัะท\n\n๐ก๏ธ **ะะปะดัะฝ ะฐะปั:**\n   โ ะขะตะบ Play Store / App Store-ะดะฐะฝ ะถาฏะบัะตาฃัะท\n   โ ะาฏะนะตะฝั ะถะฐาฃะฐัััะฟ ัาฑััาฃัะท\n   โ ะะตะนัะฐะฝัั Wi-Fi-าะฐ าะพััะปะผะฐาฃัะท",
            "ru": "๐ฑ **ะะทะปะพะผะฐะปะธ ะปะธ ะฒะฐั ัะตะปะตัะพะฝ? ะัะธะทะฝะฐะบะธ:**\n\n๐ ะััััะพ ัะฐะดะธััั ะฑะฐัะฐัะตั, ะฟะพัะฒะธะปะธัั ะฝะตะธะทะฒะตััะฝัะต ะฟัะธะปะพะถะตะฝะธั, ัะตะปะตัะพะฝ ัะพัะผะพะทะธั, ัะฒะตะปะธัะธะปัั ััะฐัะธะบ\n\n๐๏ธ **ะงัะพ ะดะตะปะฐัั:**\n   1. ะัะบะปััะธัะต Wi-Fi ะธ ะผะพะฑะธะปัะฝัะต ะดะฐะฝะฝัะต\n   2. ะฃะดะฐะปะธัะต ะฟะพะดะพะทัะธัะตะปัะฝัะต ะฟัะธะปะพะถะตะฝะธั\n   3. ะฃััะฐะฝะพะฒะธัะต ะฐะฝัะธะฒะธััั\n   4. ะกะผะตะฝะธัะต ะฒัะต ะฟะฐัะพะปะธ\n   5. ะัะพะฒะตัััะต ะฑะฐะฝะบะพะฒัะบะธะต ะฟัะธะปะพะถะตะฝะธั\n\n๐ก๏ธ ะฃััะฐะฝะฐะฒะปะธะฒะฐะนัะต ะฟัะธะปะพะถะตะฝะธั ัะพะปัะบะพ ะธะท ะพัะธัะธะฐะปัะฝัั ะผะฐะณะฐะทะธะฝะพะฒ",
            "en": "๐ฑ **Signs your phone may be hacked:**\n\nBattery drains fast, unknown apps appear, phone is slow, high data usage\n\n๐๏ธ Disconnect from internet, remove suspicious apps, install antivirus, change all passwords"
        }
    },
    {
        "id": "site_safe_check",
        "keywords": ["ัะฐะนั", "าะฐััะฟััะท", "ัะตะบัะตัั", "ะฑะตะทะพะฟะฐัะฝ", "safe", "ัะตะฝัะผะดั", "site", "check"],
        "question_patterns": ["ัะฐะนั.*าะฐััะฟััะท", "ัะฐะนั.*ัะตะบัะตั", "ัะฐะนั.*ะฑะตะทะพะฟะฐั", "site.*safe", "ัะฐะนั.*ัะตะฝัะผะดั", "ะฑาฑะป ัะฐะนั"],
        "answer": {
            "kz": "๐ **ะกะฐะนัััาฃ าะฐััะฟััะทะดัะณัะฝ ัะตะบัะตัั:**\n\nโ **าะฐััะฟััะท ัะฐะนั ะฑะตะปะณัะปะตัั:**\n   โ ะะดัะตััะต `https://` ะถำะฝะต ๐ าาฑะปัะฟ ะฑะตะปะณััั ะฑะฐั\n   โ ะะพะผะตะฝ ัะฐะฝัั: `.kz`, `.com`, `.org`\n   โ ะะธะทะฐะนะฝ ัะฐะฟะฐะปั, าะฐัะตะปะตั ะถะพา\n\n๐ซ **าะฐััะฟัั ัะฐะนั ะฑะตะปะณัะปะตัั:**\n   โ `http://` (าาฑะปัะฟััะท)\n   โ ะะพะผะตะฝ: `.tk`, `.ml`, `.xyz`\n   โ ะัะตะฝะด ะฐัั + ััะทัาัะฐ: `kaspi-login.tk`\n   โ ยซะขะตะท าฑััะฟ ะฐะป!ยป ะดะตะณะตะฝ ะถะฐัะฝะฐะผะฐ ะบำฉะฟ\n\n๐ **ะขะตะบัะตัั ะถะพะปะดะฐัั:**\n   โ CyberQalqan AI-ะดะฐ URL ัะตะบัะตััาฃัะท!\n   โ VirusTotal.com ัะฐะนััะฝะดะฐ ัะตะบัะตััาฃัะท\n   โ Google Search ะฐัาัะปั ัะฐะนั ะฟัะบััะปะตััะฝ ะพาัาฃัะท\n\n๐ก ะัาะฐัะฐะฝ ะฑะตะนัะฐะฝัั ัะฐะนัาะฐ ะถะตะบะต ะดะตัะตะบัะตััาฃัะทะดั (ะฟะฐัะพะปั, ะบะฐััะฐ ะฝำฉะผััั) ะตะฝะณัะทะฑะตาฃัะท!",
            "ru": "๐ **ะะฐะบ ะฟัะพะฒะตัะธัั ะฑะตะทะพะฟะฐัะฝะพััั ัะฐะนัะฐ:**\n\nโ HTTPS ะธ ะทะฐะผะพัะตะบ, ะทะฝะฐะบะพะผัะน ะดะพะผะตะฝ (.kz, .com)\n๐ซ ะะตั HTTPS, ัััะฐะฝะฝัะน ะดะพะผะตะฝ (.tk, .ml), ะผะฝะพะณะพ ะพัะธะฑะพะบ\n๐ ะัะพะฒะตัััะต URL ะฒ CyberQalqan AI ะธะปะธ ะฝะฐ VirusTotal.com\n๐ก ะะธะบะพะณะดะฐ ะฝะต ะฒะฒะพะดะธัะต ะปะธัะฝัะต ะดะฐะฝะฝัะต ะฝะฐ ะฟะพะดะพะทัะธัะตะปัะฝัั ัะฐะนัะฐั!",
            "en": "๐ **How to check if a site is safe:**\n\nโ Look for HTTPS and ๐ icon\n๐ซ Avoid .tk, .ml domains\n๐ Check the URL with CyberQalqan AI\n๐ก Never enter personal data on suspicious sites"
        }
    },
    {
        "id": "phishing_explain",
        "keywords": ["ัะธัะธะฝะณ", "phishing", "ัะธัะธะฝะณ ะดะตะณะตะฝ", "ััะพ ัะฐะบะพะต ัะธัะธะฝะณ", "ะฐะปะฐัาััา", "ะผะพัะตะฝะฝะธัะตััะฒะพ"],
        "question_patterns": ["ัะธัะธะฝะณ.*ะดะตะณะตะฝ", "ัะธัะธะฝะณ.*ะฝะต", "ััะพ.*ัะธัะธะฝะณ", "what.*phishing", "ัะธัะธะฝะณ.*าะฐะปะฐะน"],
        "answer": {
            "kz": "๐ฃ **ะคะธัะธะฝะณ ะดะตะณะตะฝ ะฝะต?**\n\nะคะธัะธะฝะณ โ ะฐะปะฐัาัะฐัะดัาฃ ััะทะดั ะฐะปะดะฐะฟ, ะถะตะบะต ะดะตัะตะบัะตััาฃัะทะดั (ะฟะฐัะพะปั, ะบะฐััะฐ ะฝำฉะผััั) าฑัะปะฐั ัำััะปั.\n\n**ะคะธัะธะฝะณ ัาฏัะปะตัั:**\n   ๐ง Email ัะธัะธะฝะณ โ ะถะฐะปาะฐะฝ ัะฐััะฐั\n   ๐ URL ัะธัะธะฝะณ โ ะถะฐะปาะฐะฝ ัะฐะนััะฐั\n   ๐ฑ SMS ัะธัะธะฝะณ (ัะผะธัะธะฝะณ) โ ะถะฐะปาะฐะฝ SMS\n   ๐ ะะธัะธะฝะณ โ ัะตะปะตัะพะฝ ะฐัาัะปั ะฐะปะดะฐั\n\n**ะััะฐะป:**\n   ยซKaspi Bank: ะะฐััะฐาฃัะท ะฑาฑาะฐััะฐะปะดั! ะัั าฏััะฝ ะผัะฝะฐ ััะปัะตะผะตะณะต ะฑะฐััาฃัะท: kaspi-unlock.tkยป\n   โ ะาฑะป ะะะาะะ! Kaspi ะตัาะฐัะฐะฝ ะผาฑะฝะดะฐะน SMS ะถัะฑะตัะผะตะนะดั!\n\n**าะพัาะฐะฝั:**\n   โ ะกัะปัะตะผะตะปะตัะดั CyberQalqan AI-ะดะฐ ัะตะบัะตััาฃัะท\n   โ ะะฐะฝะบะบะต ำจะ าะะะซาขะซะะะะ ัะฐะฑะฐัะปะฐััาฃัะท\n   โ ะัะบัะผะณะต SMS-ะบะพะด, CVV-ะบะพะด ะฐะนัะฟะฐาฃัะท",
            "ru": "๐ฃ **ะงัะพ ัะฐะบะพะต ัะธัะธะฝะณ?**\n\nะคะธัะธะฝะณ โ ะผะพัะตะฝะฝะธัะตััะฒะพ ั ัะตะปัั ัะบัะฐััั ะฒะฐัะธ ะดะฐะฝะฝัะต ัะตัะตะท ะฟะพะดะดะตะปัะฝัะต ัะฐะนัั, ะฟะธััะผะฐ ะธะปะธ SMS.\n\n**ะะธะดั:** email-ัะธัะธะฝะณ, ะฟะพะดะดะตะปัะฝัะต ัะฐะนัั, SMS-ัะธัะธะฝะณ, ะทะฒะพะฝะบะธ\n\n**ะะฐัะธัะฐ:** ะฟัะพะฒะตััะนัะต ัััะปะบะธ ะฒ CyberQalqan AI, ะทะฒะพะฝะธัะต ะฒ ะฑะฐะฝะบ ัะฐะผะธ, ะฝะธะบะพะผั ะฝะต ัะพะพะฑัะฐะนัะต SMS-ะบะพะดั",
            "en": "๐ฃ **What is phishing?** A scam to steal your data via fake sites, emails, or SMS. Always verify links and never share SMS codes."
        }
    },
    {
        "id": "wifi_security",
        "keywords": ["wifi", "wi-fi", "ะฒะฐะน-ัะฐะน", "ะฒะฐะนัะฐะน", "ะถะตะปั", "ัะตัั", "ัะพััะตั", "ะผะฐัััััะธะทะฐัะพั"],
        "question_patterns": ["wifi.*าะฐััะฟััะท", "wi-fi.*าะพัาะฐ", "wifi.*ะฑะตะทะพะฟะฐั", "ะฒะฐะนัะฐะน.*hack", "wifi.*ะฟะฐัะพะปั"],
        "answer": {
            "kz": "๐ถ **Wi-Fi าะฐััะฟััะทะดัะณั:**\n\n๐ **าฎะน Wi-Fi าะพัาะฐั:**\n   โ WPA3 ะฝะตะผะตัะต WPA2 ัะธััะปะฐั าะพะปะดะฐะฝัาฃัะท\n   โ ะาฏัะดะตะปั ะฟะฐัะพะปั าะพะนัาฃัะท (ะบะตะผัะฝะดะต 12 ัะธะผะฒะพะป)\n   โ ะะพััะตั ะฟะฐัะพะปัะฝ ำฉะทะณะตัััาฃัะท (admin/admin ะตะผะตั!)\n   โ SSID ะถะฐััััาะฐ ะฑะพะปะฐะดั\n   โ Firmware ะถะฐาฃะฐัััะฟ ัาฑััาฃัะท\n\nโ **าะพาะฐะผะดัา Wi-Fi (ะบะฐัะต, ะผะพะป):**\n   โ ะะฐะฝะบ าะพััะผัะฐะปะฐััะฝ ะะจะะาขะซะ\n   โ ะะฐัะพะปั, ะบะฐััะฐ ะฝำฉะผัััะฝ ะะะะะาขะซะ\n   โ VPN าะพะปะดะฐะฝัาฃัะท\n   โ ยซะะฒัะพะผะฐััั าะพััะปัะดัยป ำฉััััาฃัะท",
            "ru": "๐ถ **ะะตะทะพะฟะฐัะฝะพััั Wi-Fi:**\n\n๐ ะัะฟะพะปัะทัะนัะต WPA2/WPA3, ัะปะพะถะฝัะน ะฟะฐัะพะปั, ะพะฑะฝะพะฒะปัะนัะต ัะพััะตั\nโ ะ ะฟัะฑะปะธัะฝะพะผ Wi-Fi: ะฝะต ะทะฐัะพะดะธัะต ะฒ ะฑะฐะฝะบ, ะธัะฟะพะปัะทัะนัะต VPN, ะพัะบะปััะธัะต ะฐะฒัะพ-ะฟะพะดะบะปััะตะฝะธะต",
            "en": "๐ถ **Wi-Fi Security:** Use WPA2/WPA3, strong password, update router firmware. In public Wi-Fi: use VPN, don't access banking."
        }
    },
    {
        "id": "2fa_explain",
        "keywords": ["2fa", "ะตะบั ัะฐะบัะพัะปั", "ะดะฒัััะฐะบัะพัะฝะฐั", "two factor", "ะฐััะตะฝัะธัะธะบะฐัะธั", "authenticator", "ะฒะตัะธัะธะบะฐัะธั"],
        "question_patterns": ["2fa.*ะดะตะณะตะฝ", "ะตะบั ัะฐะบั.*าะฐะปะฐะน", "ะดะฒัััะฐะบัะพั.*ะบะฐะบ", "2fa.*what", "ะฐััะตะฝัะธัะธะบะฐัะธั.*าะพั"],
        "answer": {
            "kz": "๐ **ะะบั ัะฐะบัะพัะปั ะฐััะตะฝัะธัะธะบะฐัะธั (2FA):**\n\nะาฑะป โ าะพััะผัะฐ าะพัาะฐะฝัั ะดะตาฃะณะตะนั. ะะฐัะพะปัะดะตะฝ ะฑะฐัาะฐ, ััะทะณะต ะบะพะด าะฐะถะตั ะฑะพะปะฐะดั.\n\n**2FA ัาฏัะปะตัั:**\n   ๐ฑ SMS-ะบะพะด โ ัะตะปะตัะพะฝาะฐ ะบะพะด ะบะตะปะตะดั\n   ๐ฒ Authenticator าะพััะผัะฐัั โ Google Authenticator, Authy\n   ๐ ะะฟะฟะฐัะฐัััา ะบัะปั โ YubiKey\n\n**าะฐะนะดะฐ าะพัั ะบะตัะตะบ (ะผัะฝะดะตััั!):**\n   โ ะะฐะฝะบ าะพััะผัะฐะปะฐัั (Kaspi, Halyk)\n   โ Email (Gmail, Mail.ru)\n   โ ำะปะตัะผะตัััะบ ะถะตะปัะปะตั (Instagram, Telegram)\n   โ ะาฑะปัััา าะพะนะผะฐะปะฐั (Google Drive, iCloud)\n\n**าะฐะปะฐะน าะพัั:**\n   โ ะะฐัะฐะผะตััะปะตั โ าะฐััะฟััะทะดัะบ โ 2FA าะพัั\n   โ Authenticator าะพััะผัะฐััะฝ ะถาฏะบัะตาฃัะท\n   โ QR-ะบะพะดัั ัะบะฐะฝะตัะปะตาฃัะท\n   โ ะะตะทะตัะฒััะบ ะบะพะดัะฐัะดั ะกะาะขะาขะซะ!",
            "ru": "๐ **ะะฒัััะฐะบัะพัะฝะฐั ะฐััะตะฝัะธัะธะบะฐัะธั (2FA):**\n\nะะพะฟะพะปะฝะธัะตะปัะฝัะน ััะพะฒะตะฝั ะทะฐัะธัั. ะัะพะผะต ะฟะฐัะพะปั, ะฝัะถะตะฝ ะบะพะด.\n\n**ะะดะต ะฒะบะปััะธัั:** ะฑะฐะฝะบะธ, email, ัะพััะตัะธ, ะพะฑะปะฐะบะพ\n**ะะฐะบ:** ะะฐัััะพะนะบะธ โ ะะตะทะพะฟะฐัะฝะพััั โ 2FA โ Authenticator",
            "en": "๐ **Two-Factor Authentication (2FA):** Extra security layer. Enable it on banking, email, social media. Use an Authenticator app."
        }
    },
    {
        "id": "social_engineering",
        "keywords": ["ำะปะตัะผะตัััะบ ะธะฝะถะตะฝะตัะธั", "ัะพัะธะฐะปัะฝะฐั ะธะฝะถะตะฝะตัะธั", "social engineering", "ะฐะปะดะฐั", "ะพะฑะผะฐะฝ", "ะผะพัะตะฝะฝะธะบ", "ะฐะปะฐัา", "าฑัะปะฐั"],
        "question_patterns": ["ำะปะตัะผะตัััะบ ะธะฝะถะตะฝะตัะธั", "ัะพัะธะฐะปัะฝะฐั ะธะฝะถะตะฝะตัะธั", "ะฐะปะฐัา.*าะฐะปะฐะน", "ะผะพัะตะฝะฝะธะบ.*ะบะฐะบ", "ะถะตะบะต.*ะดะตัะตะบ.*าฑัะปะฐ"],
        "answer": {
            "kz": "๐ญ **ำะปะตัะผะตัััะบ ะธะฝะถะตะฝะตัะธั โ ะฐะดะฐะผะดั ะฐะปะดะฐั ัำััะปั:**\n\n**ะะธั ะบะตะทะดะตัะตััะฝ ัำััะปะดะตั:**\n   ๐ ะะฐะฝะบ าัะทะผะตัะบะตัั ะฑะพะฟ าะพาฃััะฐั ัะฐะปั\n   ๐ง ะะตัะผะธ ัะฐัาะฐ าฑาัะฐั ะถะฐะปาะฐะฝ email ะถัะฑะตัั\n   ๐ฌ ะะพัััาฃ ะฐะบะบะฐัะฝััะฝะฐะฝ ัะฐะฑะฐัะปะฐะผะฐ ะถัะฑะตัั\n   ๐ ยซะขะตะณัะฝ ััะนะปัา าฑััะฟ ะฐะปะดัาฃัะท!ยป\n\n**าะพัาะฐะฝั:**\n   โ ะกะตะฝะฑะตาฃัะท! ะขะตะบัะตััาฃัะท!\n   โ ะะฐะฝะบ าัะทะผะตัะบะตัั SMS-ะบะพะด ะะจาะะจะะ ัาฑัะฐะผะฐะนะดั\n   โ ะะพััาฃัะท ะฐาัะฐ ัาฑัะฐัะฐ โ าะพาฃััะฐั ัะฐะปัะฟ ัะตะบัะตััาฃัะท\n   โ าัััะผ ะถะฐัะฐัะฐ โ ะฐะปะฐัา ะตะบะตะฝัะฝ ะฑัะปะดััะตะดั",
            "ru": "๐ญ **ะกะพัะธะฐะปัะฝะฐั ะธะฝะถะตะฝะตัะธั โ ะพะฑะผะฐะฝ ะปัะดะตะน:**\n\nะะฒะพะฝะบะธ ยซะธะท ะฑะฐะฝะบะฐยป, ะฟะพะดะดะตะปัะฝัะต email, ัะพะพะฑัะตะฝะธั ะพั ยซะดััะทะตะนยป, ยซะฑะตัะฟะปะฐัะฝัะต ะฟัะธะทัยป\n\n**ะะฐัะธัะฐ:** ะฝะต ะฒะตัััะต, ะฟัะพะฒะตััะนัะต, ะฑะฐะฝะบ ะฝะธะบะพะณะดะฐ ะฝะต ะฟัะพัะธั SMS-ะบะพะด",
            "en": "๐ญ **Social Engineering:** Manipulation through fake calls, emails, messages. Never trust unsolicited requests for personal info."
        }
    },
    {
        "id": "vpn_explain",
        "keywords": ["vpn", "ะฒะฟะฝ", "ะฒะธัััะฐะปะดั", "ะฒะธัััะฐะปัะฝะฐั", "proxy", "ะฟัะพะบัะธ"],
        "question_patterns": ["vpn.*ะดะตะณะตะฝ", "vpn.*ะฝะต", "ะฒะฟะฝ.*าะฐะปะฐะน", "vpn.*what", "vpn.*ะบะตัะตะบ"],
        "answer": {
            "kz": "๐ **VPN ะดะตะณะตะฝ ะฝะต?**\n\nVPN โ ะธะฝัะตัะฝะตััะตะณั ะดะตัะตะบัะตััาฃัะทะดั ัะธััะปะฐะนััะฝ าาฑัะฐะป. ะกัะทะดัาฃ IP-ะผะตะบะตะฝะถะฐะนัาฃัะทะดั ะถะฐัััะฐะดั.\n\n**าะฐัะฐะฝ ะบะตัะตะบ:**\n   โ าะพาะฐะผะดัา Wi-Fi าะพะปะดะฐะฝาะฐะฝะดะฐ\n   โ ะะตะบะต ะดะตัะตะบัะตัะดั าะพัาะฐั าฏััะฝ\n   โ ะาฑาะฐััะฐะปาะฐะฝ ัะฐะนััะฐัาะฐ ะบััั าฏััะฝ\n\n**ะกะตะฝัะผะดั VPN:**\n   โ ProtonVPN (ัะตะณัะฝ ะฝาฑัาะฐัั ะฑะฐั)\n   โ Windscribe (10 ะะ ัะตะณัะฝ)\n   โ NordVPN, ExpressVPN (ะฐาัะปั)\n\nโ๏ธ ะขะตะณัะฝ VPN-ะดะตัะณะต ัะฐา ะฑะพะปัาฃัะท โ ะพะปะฐั ะดะตัะตะบัะตััาฃัะทะดั ัะฐััั ะผาฏะผะบัะฝ!",
            "ru": "๐ **VPN** ัะธัััะตั ะฒะฐั ะธะฝัะตัะฝะตั-ััะฐัะธะบ.\n\n**ะะพะณะดะฐ ะฝัะถะตะฝ:** ะฟัะฑะปะธัะฝัะน Wi-Fi, ะทะฐัะธัะฐ ะดะฐะฝะฝัั\n**ะะฐะดัะถะฝัะต:** ProtonVPN, Windscribe, NordVPN\nโ๏ธ ะะตัะฟะปะฐัะฝัะต VPN ะผะพะณัั ะฟัะพะดะฐะฒะฐัั ะฒะฐัะธ ะดะฐะฝะฝัะต!",
            "en": "๐ **VPN** encrypts your internet traffic. Use ProtonVPN or Windscribe. Be careful with free VPNs."
        }
    },
    {
        "id": "whatsapp_telegram",
        "keywords": ["whatsapp", "ะฒะฐััะฐะฟ", "telegram", "ัะตะปะตะณัะฐะผ", "ะผะตััะตะฝะดะถะตั", "ัะฐะฑะฐัะปะฐะผะฐ"],
        "question_patterns": ["whatsapp.*าะพัาะฐ", "ะฒะฐััะฐะฟ.*ะฑะตะทะพะฟะฐั", "telegram.*าะพัาะฐ", "ัะตะปะตะณัะฐะผ.*hack", "ะผะตััะตะฝะดะถะตั.*าะฐััะฟััะท"],
        "answer": {
            "kz": "๐ฌ **ะะตััะตะฝะดะถะตัะปะตัะดั าะพัาะฐั (WhatsApp/Telegram):**\n\n**WhatsApp:**\n   โ ะะฐัะฐะผะตััะปะตั โ ะะบะบะฐัะฝั โ ะะบั าะฐะดะฐะผะดั ัะตะบัะตัั โ 6 ัะฐะฝะดั PIN าะพะนัาฃัะท\n   โ ยซะกะพาฃาั ัะตั ะบััะณะตะฝยป ะฐาะฟะฐัะฐััะฝ ะถะฐััััาฃัะท\n   โ WhatsApp Web ัะตะฐะฝััะฐััะฝ ัะตะบัะตััาฃัะท\n\n**Telegram:**\n   โ 2FA าะพััาฃัะท: ะะฐัะฐะผะตััะปะตั โ าาฑะฟะธัะปัะปัา โ ะาฑะปัััา ะฟะฐัะพะปั\n   โ ะะฒัะพะผะฐััั ะถะพั ัะฐะนะผะตััะฝ าะพััาฃัะท\n   โ ะขะตะปะตัะพะฝ ะฝำฉะผัััาฃัะทะดั ะถะฐััััาฃัะท\n\nโ๏ธ **ะััะฐา ะตัะตะถะตะปะตั:**\n   โ ะะตะปะณัััะท ะฑะพััะฐัาะฐ ะถะตะบะต ะดะตัะตะบัะตั ะถะฐะทะฑะฐาฃัะท\n   โ ะขะพะฟัะฐัะดะฐาั ััะปัะตะผะตะปะตัะณะต ัะฐา ะฑะพะปัาฃัะท\n   โ ยซะะบะบะฐัะฝั ะธะตััยป ะดะตะฟ ัะฐะฑะฐัะปะฐัาะฐะฝะดะฐัาะฐ ัะตะฝะฑะตาฃัะท",
            "ru": "๐ฌ **ะะฐัะธัะฐ ะผะตััะตะฝะดะถะตัะพะฒ:**\n\nWhatsApp: ะฒะบะปััะธัะต ะดะฒัััะฐะณะพะฒัั ะฟัะพะฒะตัะบั (PIN ะธะท 6 ัะธัั)\nTelegram: ะฒะบะปััะธัะต ะพะฑะปะฐัะฝัะน ะฟะฐัะพะปั ะฒ ะฝะฐัััะพะนะบะฐั\n\nโ๏ธ ะะต ะฟะตัะตัะพะดะธัะต ะฟะพ ัััะปะบะฐะผ ะพั ะฝะตะทะฝะฐะบะพะผัะตะฒ, ะฝะต ะดะตะปะธัะตัั ะบะพะดะฐะผะธ",
            "en": "๐ฌ **Messenger Security:** Enable 2FA on WhatsApp and Telegram. Don't click links from strangers."
        }
    },
    {
        "id": "online_shopping",
        "keywords": ["ะพะฝะปะฐะนะฝ", "ะดาฏะบะตะฝ", "ะฟะพะบัะฟะบะฐ", "shopping", "ัะฐััะฟ ะฐะปั", "ะบะฐััะฐ", "ัำฉะปะตะผ", "ะพะฟะปะฐัะฐ", "ะธะฝัะตัะฝะตั-ะดาฏะบะตะฝ"],
        "question_patterns": ["ะพะฝะปะฐะนะฝ.*ัะฐััะฟ", "ะธะฝัะตัะฝะตั.*ะดาฏะบะตะฝ", "ะบะฐััะฐ.*าะฐััะฟััะท", "ะพะฝะปะฐะนะฝ.*ะฟะพะบัะฟ", "ัำฉะปะตะผ.*าะพัาะฐ"],
        "answer": {
            "kz": "๐ **ะะฝะปะฐะนะฝ ัะฐััะฟ ะฐะปั าะฐััะฟััะทะดัะณั:**\n\nโ **าะฐััะฟััะท ัะฐััะฟ ะฐะปั:**\n   โ ะขะตะบ ัะตะฝัะผะดั ะดาฏะบะตะฝะดะตัะดะตะฝ (Kaspi, Wildberries, Amazon)\n   โ HTTPS ะฑะฐั ัะฐะนััะฐัะดะฐะฝ าะฐะฝะฐ\n   โ ะะธัััะฐะปะดั ะบะฐััะฐ าะพะปะดะฐะฝัาฃัะท\n   โ SMS-ัะฐะฑะฐัะปะฐะฝะดัััะดั าะพััาฃัะท\n\nโ **าะฐััะฟัั:**\n   โ ะะตะปะณัััะท ัะฐะนััะฐัาะฐ ะบะฐััะฐ ะดะตัะตะบัะตััะฝ ะตะฝะณัะทั\n   โ ยซะขัะผ ะฐัะทะฐะฝยป าฑััะฝัััะฐัาะฐ ัะตะฝั\n   โ SMS-ะบะพะดัั ยซัะฐััััาะฐยป ะฐะนัั\n\n๐ก **ะะตาฃะตั:** Kaspi-ะดะต ะฒะธัััะฐะปะดั ะบะฐััะฐ ะฐััะฟ, ัะตะบ ัะพะฝั าะพะปะดะฐะฝัาฃัะท. ะะธะผะธั าะพะนัาฃัะท!",
            "ru": "๐ **ะะตะทะพะฟะฐัะฝัะต ะฟะพะบัะฟะบะธ ะพะฝะปะฐะนะฝ:**\n\nโ ะขะพะปัะบะพ ะฟัะพะฒะตัะตะฝะฝัะต ะผะฐะณะฐะทะธะฝั, HTTPS, ะฒะธัััะฐะปัะฝะฐั ะบะฐััะฐ\nโ ะะต ะฒะฒะพะดะธัะต ะดะฐะฝะฝัะต ะฝะฐ ะฝะตะธะทะฒะตััะฝัั ัะฐะนัะฐั\n๐ก ะัะฟะพะปัะทัะนัะต ะฒะธัััะฐะปัะฝัั ะบะฐััั ั ะปะธะผะธัะพะผ",
            "en": "๐ **Safe Online Shopping:** Use trusted stores, HTTPS sites, virtual cards with spending limits."
        }
    },
    {
        "id": "data_leak",
        "keywords": ["ะดะตัะตะบัะตั", "ะฐาั", "ััะตัะบะฐ", "ะดะฐะฝะฝัั", "leak", "breach", "ะถะตะบะต ะดะตัะตะบัะตั", "ะฟะตััะพะฝะฐะปัะฝัะต"],
        "question_patterns": ["ะดะตัะตะบัะตั.*ะฐา", "ััะตัะบะฐ.*ะดะฐะฝะฝัั", "data.*leak", "ะถะตะบะต.*ะดะตัะตะบ.*าะพัาะฐ", "ะฟะตััะพะฝะฐะปั.*ะดะฐะฝะฝ"],
        "answer": {
            "kz": "๐ **ะะตะบะต ะดะตัะตะบัะตัะดัาฃ ะฐาัั:**\n\n**ะขะตะบัะตัั:**\n   โ haveibeenpwned.com โ email-ัาฃัะท ะฐาัะฟ ะบะตัะบะตะฝ ะฑะต?\n   โ ะะฐะฝะบ ัะฐะฑะฐัะปะฐะฝะดัััะปะฐััะฝ าะฐะดะฐาะฐะปะฐาฃัะท\n\n**ะาั ะฑะพะปัะฐ ะฝะต ัััะตั:**\n   1. ะะฐัะปัา ะฟะฐัะพะปัะดะตัะดั ะะะะะฃ ะฐัััััััาฃัะท\n   2. 2FA าะพััาฃัะท\n   3. ะะฐะฝะบ ะบะฐััะฐััะฝ าะฐะนัะฐ ััาะฐััาฃัะท\n   4. ะาฏะดัะบัั ััะฐะฝะทะฐะบัะธัะปะฐัะดั ัะตะบัะตััาฃัะท\n\n**ะะปะดัะฝ ะฐะปั:**\n   โ ำั ัะฐะนััะฐ ะฑำฉะปะตะบ ะฟะฐัะพะปั าะพะปะดะฐะฝัาฃัะท\n   โ าะฐะถะตัััะท ะฐะบะบะฐัะฝััะฐัะดั ะถะพะนัาฃัะท\n   โ ะะตะบะต ะดะตัะตะบัะตัะดั ะฐะท ะฑำฉะปัััาฃัะท",
            "ru": "๐ **ะฃัะตัะบะฐ ะดะฐะฝะฝัั:**\n\nะัะพะฒะตัััะต ะฝะฐ haveibeenpwned.com. ะัะปะธ ััะตัะบะฐ: ัะผะตะฝะธัะต ะฟะฐัะพะปะธ, ะฒะบะปััะธัะต 2FA, ะฟะตัะตะฒัะฟัััะธัะต ะบะฐััั.",
            "en": "๐ **Data Breach:** Check haveibeenpwned.com. If breached: change passwords, enable 2FA, reissue bank cards."
        }
    },
    {
        "id": "children_safety",
        "keywords": ["ะฑะฐะปะฐ", "ัะตะฑะตะฝะพะบ", "ะดะตัะธ", "ะฑะฐะปะฐะปะฐั", "children", "ะฐัะฐ-ะฐะฝะฐ", "ัะพะดะธัะตะป", "parent"],
        "question_patterns": ["ะฑะฐะปะฐ.*าะพัาะฐ", "ะฑะฐะปะฐ.*ะธะฝัะตัะฝะตั", "ะดะตั.*ะฑะตะทะพะฟะฐั", "ัะตะฑะตะฝะพะบ.*ะธะฝัะตัะฝะตั", "ะฑะฐะปะฐะปะฐั.*าะฐััะฟััะท"],
        "answer": {
            "kz": "๐จโ๐ฉโ๐ง **ะะฐะปะฐะปะฐัะดั ะธะฝัะตัะฝะตััะต าะพัาะฐั:**\n\n1๏ธโฃ **ะัะฐ-ะฐะฝะฐ ะฑะฐาัะปะฐััะฝ าะพััาฃัะท:**\n   โ Google Family Link (Android)\n   โ Screen Time (iPhone)\n\n2๏ธโฃ **ะัะตะถะตะปะตั าะพะนัาฃัะท:**\n   โ ะะตะบะต ะฐาะฟะฐัะฐั ะฑำฉะปััะฟะตั\n   โ ะะตะนัะฐะฝััะดะฐัะผะตะฝ ัำฉะนะปะตัะฟะตั\n   โ ะาฏะดัะบัั ะฝำััะต ัััะฐะปั ะฐะนัั\n\n3๏ธโฃ **ะััะณะต าะพะปะดะฐะฝัาฃัะท:**\n   โ ะะฐะปะฐะผะตะฝ ะฑััะณะต ะธะฝัะตัะฝะตั าะพะปะดะฐะฝัาฃัะท\n   โ าะฐะฝะดะฐะน ัะฐะนััะฐัาะฐ ะบััะตััะฝัะฝ ะฑัะปัาฃัะท\n   โ ะกะตะฝัะผะดั าะฐััะผ-าะฐััะฝะฐั ะพัะฝะฐััาฃัะท",
            "ru": "๐จโ๐ฉโ๐ง **ะะตะทะพะฟะฐัะฝะพััั ะดะตัะตะน ะฒ ะธะฝัะตัะฝะตัะต:**\n\nะะบะปััะธัะต ัะพะดะธัะตะปััะบะธะน ะบะพะฝััะพะปั, ัััะฐะฝะพะฒะธัะต ะฟัะฐะฒะธะปะฐ, ะฟัะพะฒะพะดะธัะต ะฒัะตะผั ะพะฝะปะฐะนะฝ ะฒะผะตััะต ั ัะตะฑัะฝะบะพะผ.",
            "en": "๐จโ๐ฉโ๐ง **Children's Online Safety:** Use parental controls, set rules, browse together with your child."
        }
    },
    {
        "id": "antivirus",
        "keywords": ["ะฐะฝัะธะฒะธััั", "ะฒะธััั", "ะผะฐะปะฒะฐัะต", "malware", "ะทะธัะฝะดั ะฑะฐาะดะฐัะปะฐะผะฐ", "ะฒัะตะดะพะฝะพัะฝะพะต", "ััะพัะฝ", "ransomware"],
        "question_patterns": ["ะฐะฝัะธะฒะธััั.*าะฐะปะฐะน", "ะฒะธััั.*าะพัาะฐ", "ะผะฐะปะฒะฐัะต.*ะฝะต", "ะฐะฝัะธะฒะธััั.*าะฐะนัั", "ะฒะธััั.*ัะตะบัะตั"],
        "answer": {
            "kz": "๐ฆ **ะะฝัะธะฒะธััั ะถำะฝะต ะฒะธััััะฐัะดะฐะฝ าะพัาะฐะฝั:**\n\n**าฐััะฝัะปะฐััะฝ ะฐะฝัะธะฒะธััััะฐั:**\n   ๐ฅ๏ธ ะะพะผะฟัััะตั: Kaspersky, ESET, Malwarebytes\n   ๐ฑ ะขะตะปะตัะพะฝ: Kaspersky Mobile, Dr.Web Light\n   ๐ฐ ะขะตะณัะฝ: Windows Defender (Windows 10/11-ะดะต ะฑะฐั)\n\n**ะะธััั ะฑะตะปะณัะปะตัั:**\n   โ ะะพะผะฟัััะตั/ัะตะปะตัะพะฝ ะฑะฐััะปะฐะดั\n   โ ะะตะปะณัััะท ะฑะฐาะดะฐัะปะฐะผะฐะปะฐั ะฟะฐะนะดะฐ ะฑะพะปะดั\n   โ ะคะฐะนะปะดะฐั ะถะพาะฐะปะดั ะฝะตะผะตัะต ัะธััะปะฐะฝะดั\n   โ ะะฐัะฝะฐะผะฐ ะบำฉะฟ ััาะฐะดั\n\n**าะพัาะฐะฝั:**\n   โ ะะฝัะธะฒะธััััั ะถะฐาฃะฐัััะฟ ัาฑััาฃัะท\n   โ ะะตะปะณัััะท ัะฐะนะปะดะฐัะดั ะฐัะฟะฐาฃัะท\n   โ ะขะตะบ ัะตัะผะธ ะดาฏะบะตะฝะดะตัะดะตะฝ ะถาฏะบัะตาฃัะท\n   โ ะคะฐะนะปะดะฐััาฃัะทะดั ะฑัะบะฐะฟ ะถะฐัะฐาฃัะท",
            "ru": "๐ฆ **ะะฝัะธะฒะธััั:** Kaspersky, ESET, Malwarebytes ะธะปะธ ะฑะตัะฟะปะฐัะฝัะน Windows Defender. ะะฑะฝะพะฒะปัะนัะต ัะตะณัะปััะฝะพ.",
            "en": "๐ฆ **Antivirus:** Use Kaspersky, ESET, or built-in Windows Defender. Keep it updated."
        }
    },
    {
        "id": "greeting",
        "keywords": ["ัำะปะตะผ", "ัำะปะตะผะตัััะท", "ะฟัะธะฒะตั", "hello", "hi", "าะฐะนััะปั", "ะทะดัะฐะฒััะฒัะนัะต", "hey"],
        "question_patterns": ["^ัำะปะตะผ", "^ะฟัะธะฒะตั", "^hello", "^hi$", "^าะฐะนััะปั", "^ะทะดัะฐะฒััะฒัะน"],
        "answer": {
            "kz": "๐ **ะกำะปะตะผะตัััะท ะฑะต!** ะะตะฝ โ CyberQalqan AI ะบะธะฑะตัาะฐััะฟััะทะดัะบ ะบะตาฃะตัััััะผัะฝ.\n\nะะฐาะฐะฝ ะบะตะท ะบะตะปะณะตะฝ ัาฑัะฐา าะพั ะฐะปะฐััะท:\n   ๐ ะะฐัะพะปัะดั าะฐะปะฐะน าะพัาะฐัาะฐ ะฑะพะปะฐะดั?\n   ๐ฑ ะขะตะปะตัะพะฝัะผ ะฑาฑะทัะปะดั ะผะฐ?\n   ๐ ะาฑะป ัะฐะนั าะฐััะฟััะท ะฑะต?\n   ๐ธ Instagram ะฐะบะบะฐัะฝััะผะดั าะฐะปะฐะน าะพัาะฐะนะผัะฝ?\n   ๐ถ Wi-Fi าะฐััะฟััะทะดัะณั\n   ๐ฃ ะคะธัะธะฝะณ ะดะตะณะตะฝ ะฝะต?\n\nะกาฑัะฐาัาฃัะทะดั ะถะฐะทัาฃัะท! ๐",
            "ru": "๐ **ะะดัะฐะฒััะฒัะนัะต!** ะฏ โ ะะ-ะบะพะฝััะปััะฐะฝั CyberQalqan ะฟะพ ะบะธะฑะตัะฑะตะทะพะฟะฐัะฝะพััะธ.\n\nะะฐะดะฐะนัะต ะผะฝะต ะปัะฑะพะน ะฒะพะฟัะพั ะพ ะฑะตะทะพะฟะฐัะฝะพััะธ ะฒ ะธะฝัะตัะฝะตัะต!",
            "en": "๐ **Hello!** I'm the CyberQalqan AI cybersecurity advisor. Ask me anything about online safety!"
        }
    },
]

# Quick responses for common short phrases
QUICK_RESPONSES = {
    "ัะฐาะผะตั": {"kz": "ะาะฐัั ะถะพา! ๐ ะขะฐาั ัาฑัะฐาัาฃัะท ะฑะพะปัะฐ, ะถะฐะทัาฃัะท!", "ru": "ะะพะถะฐะปัะนััะฐ! ๐", "en": "You're welcome! ๐"},
    "ัะฟะฐัะธะฑะพ": {"kz": "ะาะฐัั ะถะพา! ๐", "ru": "ะะพะถะฐะปัะนััะฐ! ะะฑัะฐัะฐะนัะตัั ะตัั! ๐", "en": "You're welcome! ๐"},
    "thanks": {"kz": "ะาะฐัั ะถะพา! ๐", "ru": "ะะพะถะฐะปัะนััะฐ! ๐", "en": "You're welcome! Feel free to ask more! ๐"},
    "thank you": {"kz": "ะาะฐัั ะถะพา! ๐", "ru": "ะะพะถะฐะปัะนััะฐ! ๐", "en": "You're welcome! ๐"},
    "ะบำฉะผะตะบ": {"kz": "ะะตะฝ ััะทะณะต ะบำฉะผะตะบัะตััะณะต ะดะฐะนัะฝะผัะฝ! าะฐะฝะดะฐะน ัาฑัะฐาัาฃัะท ะฑะฐั?", "ru": "ะฏ ะณะพัะพะฒ ะฟะพะผะพัั! ะะฐะบะพะน ั ะฒะฐั ะฒะพะฟัะพั?", "en": "I'm ready to help! What's your question?"},
    "help": {"kz": "ะะตะฝ ะบำฉะผะตะบัะตััะณะต ะดะฐะนัะฝะผัะฝ!", "ru": "ะฏ ะณะพัะพะฒ ะฟะพะผะพัั!", "en": "I'm ready to help! What's your question?"},
}

DEFAULT_RESPONSE = {
    "kz": "๐ค ะะตััััาฃัะท, ะฑาฑะป ัาฑัะฐาาะฐ ะฝะฐาัั ะถะฐัะฐะฟ ัะฐะฑะฐ ะฐะปะผะฐะดัะผ.\n\n๐ก ะัะฝะฐ ัะฐาัััะฟัะฐั ะฑะพะนัะฝัะฐ ัาฑัะฐะน ะฐะปะฐััะท:\n   โ ะะฐัะพะปั าะฐััะฟััะทะดัะณั\n   โ Instagram/WhatsApp/Telegram าะพัาะฐั\n   โ ะขะตะปะตัะพะฝ ะฑาฑะทัะปะดั ะผะฐ?\n   โ ะกะฐะนั าะฐััะฟััะท ะฑะต?\n   โ ะคะธัะธะฝะณ ะดะตะณะตะฝ ะฝะต?\n   โ Wi-Fi าะฐััะฟััะทะดัะณั\n   โ VPN ะดะตะณะตะฝ ะฝะต?\n   โ ะะฝะปะฐะนะฝ ัะฐััะฟ ะฐะปั าะฐััะฟััะทะดัะณั\n   โ 2FA (ะตะบั ัะฐะบัะพัะปั ะฐััะตะฝัะธัะธะบะฐัะธั)\n   โ ะะฐะปะฐะปะฐัะดั ะธะฝัะตัะฝะตััะต าะพัาะฐั\n\nะกาฑัะฐาัาฃัะทะดั ะฑะฐัาะฐัะฐ าะพะนัะฟ ะบำฉััาฃัะท! ๐",
    "ru": "๐ค ะะทะฒะธะฝะธัะต, ั ะฝะต ะฝะฐััะป ัะพัะฝะพะณะพ ะพัะฒะตัะฐ.\n\n๐ก ะฏ ะผะพะณั ะฟะพะผะพัั ั: ะฟะฐัะพะปะธ, Instagram, ัะตะปะตัะพะฝ, ัะธัะธะฝะณ, Wi-Fi, VPN, 2FA.\n\nะะพะฟัะพะฑัะนัะต ะฟะตัะตัะพัะผัะปะธัะพะฒะฐัั ะฒะพะฟัะพั! ๐",
    "en": "๐ค Sorry, I couldn't find an exact answer.\n\n๐ก I can help with: passwords, Instagram, phone security, phishing, Wi-Fi, VPN, 2FA.\n\nTry rephrasing your question! ๐"
}


def find_best_answer(message: str) -> Dict[str, str]:
    """Find the best matching answer from the knowledge base."""
    msg = message.lower().strip()

    # Check quick responses first
    for key, response in QUICK_RESPONSES.items():
        if key in msg:
            return response

    # Score each knowledge base entry
    best_score = 0
    best_entry = None

    for entry in KNOWLEDGE_BASE:
        score = 0

        # Check keyword matches
        for kw in entry["keywords"]:
            if kw.lower() in msg:
                score += 3 if len(kw) >= 5 else 2

        # Check pattern matches (regex)
        for pattern in entry["question_patterns"]:
            try:
                if re.search(pattern, msg, re.IGNORECASE):
                    score += 5
            except re.error:
                pass

        if score > best_score:
            best_score = score
            best_entry = entry

    if best_entry and best_score >= 2:
        return best_entry["answer"]

    return DEFAULT_RESPONSE


def get_chat_response(message: str) -> Dict[str, any]:
    """Get a chat response for the given message."""
    answer = find_best_answer(message)
    return {
        "answer": answer,
        "source": "CyberQalqan AI Knowledge Base",
    }


# Suggested questions for the chat UI
SUGGESTED_QUESTIONS = [
    {"kz": "Instagram ะฐะบะบะฐัะฝััะผะดั าะฐะปะฐะน าะพัาะฐะนะผัะฝ?", "icon": "๐ธ"},
    {"kz": "ะขะตะปะตัะพะฝัะผ ะฑาฑะทัะปะดั ะผะฐ?", "icon": "๐ฑ"},
    {"kz": "ะคะธัะธะฝะณ ะดะตะณะตะฝ ะฝะต?", "icon": "๐ฃ"},
    {"kz": "ะกะตะฝัะผะดั ะฟะฐัะพะปั าะฐะปะฐะน ะถะฐัะฐะนะผัะฝ?", "icon": "๐"},
    {"kz": "Wi-Fi าะฐััะฟััะทะดัะณั", "icon": "๐ถ"},
    {"kz": "ะาฑะป ัะฐะนั าะฐััะฟััะท ะฑะต?", "icon": "๐"},
    {"kz": "VPN ะดะตะณะตะฝ ะฝะต?", "icon": "๐"},
    {"kz": "2FA ะดะตะณะตะฝ ะฝะต?", "icon": "๐"},
]
