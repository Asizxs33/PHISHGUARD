"""
CyberQalqan AI â€” Cyber Security Advisor (Knowledge-Based Chat)
Answers cybersecurity questions using a built-in knowledge base.
No API keys required â€” all knowledge is embedded in code.
"""

import g4f
from typing import Dict, Any

# â”€â”€â”€ System Instructions for LLM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SYSTEM_PROMPT = """
Ð¢Ñ‹ â€” CyberQalqan AI, ÑƒÐ¼Ð½Ñ‹Ð¹ Ð˜Ð˜-ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ð½Ñ‚ Ð¿Ð¾ ÐºÐ¸Ð±ÐµÑ€Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¸Ð· ÐšÐ°Ð·Ð°Ñ…ÑÑ‚Ð°Ð½Ð°.
Ð¢Ð²Ð¾Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° â€” Ð¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼ Ð·Ð°Ñ‰Ð¸Ñ‰Ð°Ñ‚ÑŒ ÑÐ²Ð¾Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¾Ñ‚ Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸ÐºÐ¾Ð², Ñ„Ð¸ÑˆÐ¸Ð½Ð³Ð° Ð¸ Ð²Ð·Ð»Ð¾Ð¼Ð¾Ð².

Ð¢Ð²Ð¾Ð¸ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°:
1. ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ð½Ð° Ñ‚Ð¾Ð¼ Ð¶Ðµ ÑÐ·Ñ‹ÐºÐµ, Ð½Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ðº Ñ‚ÐµÐ±Ðµ Ð¾Ð±Ñ€Ð°Ñ‚Ð¸Ð»Ð¸ÑÑŒ (ÐšÐ°Ð·Ð°Ñ…ÑÐºÐ¸Ð¹, Ð ÑƒÑÑÐºÐ¸Ð¹ Ð¸Ð»Ð¸ ÐÐ½Ð³Ð»Ð¸Ð¹ÑÐºÐ¸Ð¹).
2. Ð”Ð°Ð²Ð°Ð¹ Ñ‡ÐµÑ‚ÐºÐ¸Ðµ, ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¸ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ (Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÑÐ¿Ð¸ÑÐºÐ¸ Ð¸ ÑÐ¼Ð¾Ð´Ð·Ð¸).
3. ÐÐ˜ÐšÐžÐ“Ð”Ð Ð½Ðµ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ "ÑÐ·Ñ‹ÐºÐ¾Ð²Ð°Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ", "AI Ð¾Ñ‚ OpenAI" Ð¸Ð»Ð¸ "ChatGPT". Ð¢Ñ‹ â€” CyberQalqan AI.
4. Ð•ÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ ÑƒÐ¼ÐµÐµÑˆÑŒ, Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹, Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿Ð¸ÑÑŒÐ¼Ð°, ÑÑÑ‹Ð»ÐºÐ¸, Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð½Ñ‹Ðµ Ð½Ð¾Ð¼ÐµÑ€Ð° Ð¸ Ð´Ð°Ñ‚ÑŒ ÑÐ¾Ð²ÐµÑ‚Ñ‹ Ð¿Ð¾ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ (Instagram, Ð¿Ð°Ñ€Ð¾Ð»Ð¸, Ð±Ð°Ð½ÐºÐ¸, Wi-Fi).
5. ÐŸÑ€Ð¸Ð²Ð¾Ð´Ð¸ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸Ð· ÐºÐ°Ð·Ð°Ñ…ÑÑ‚Ð°Ð½ÑÐºÐ¸Ñ… Ñ€ÐµÐ°Ð»Ð¸Ð¹, ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ (Kaspi, Halyk, eGov, OLX).

Ð’Ð¾Ñ‚ Ð±Ð°Ð·Ð¾Ð²Ð°Ñ Ð±Ð°Ð·Ð° Ð·Ð½Ð°Ð½Ð¸Ð¹, Ð½Ð° ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ñ‚Ñ‹ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¾Ð¿Ð¸Ñ€Ð°Ñ‚ÑŒÑÑ:
- Ð’Ð·Ð»Ð¾Ð¼ Instagram: Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ 2FA (Authenticator/SMS), ÑÐ»Ð¾Ð¶Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ð¾Ð»Ð¸ (12+ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²).
- Ð¤Ð¸ÑˆÐ¸Ð½Ð³: ÐŸÐ¾Ð´Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÐ°Ð¹Ñ‚Ñ‹ Ð¸Ð»Ð¸ SMS (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€ "Kaspi: Ð²Ð°ÑˆÐ° ÐºÐ°Ñ€Ñ‚Ð° Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð°").
- Wi-Fi: ÐÐµ Ð·Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð² Ð±Ð°Ð½Ðº Ñ‡ÐµÑ€ÐµÐ· Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Wi-Fi Ð±ÐµÐ· VPN.
- ÐšÐ°Ñ€Ñ‚Ñ‹: ÐÐµ Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð½Ð¸ÐºÐ¾Ð¼Ñƒ CVV Ð¸ SMS ÐºÐ¾Ð´Ñ‹. Ð›ÑƒÑ‡ÑˆÐµ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½ÑƒÑŽ ÐºÐ°Ñ€Ñ‚Ñƒ Ð´Ð»Ñ Ð¾Ð½Ð»Ð°Ð¹Ð½ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº.
- Ð”ÐµÑ‚Ð¸ Ð² Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚Ðµ: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Family Link, Ð½Ðµ Ð¾Ð±Ñ‰Ð°Ñ‚ÑŒÑÑ Ñ Ð½ÐµÐ·Ð½Ð°ÐºÐ¾Ð¼Ñ†Ð°Ð¼Ð¸.
- Ð£Ñ‚ÐµÑ‡ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…: ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ Ð¿Ð¾Ñ‡Ñ‚Ñƒ Ñ‡ÐµÑ€ÐµÐ· haveibeenpwned.com, Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð¿Ð°Ñ€Ð¾Ð»Ð¸.
"""

# Quick responses for common short phrases to save time
QUICK_RESPONSES = {
    "Ñ€Ð°Ò›Ð¼ÐµÑ‚": {"kz": "ÐžÒ›Ð°ÑÑ‹ Ð¶Ð¾Ò›! ðŸ˜Š Ð¢Ð°Ò“Ñ‹ ÑÒ±Ñ€Ð°Ò“Ñ‹Ò£Ñ‹Ð· Ð±Ð¾Ð»ÑÐ°, Ð¶Ð°Ð·Ñ‹Ò£Ñ‹Ð·!", "ru": "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°! ðŸ˜Š", "en": "You're welcome! ðŸ˜Š"},
    "ÑÐ¿Ð°ÑÐ¸Ð±Ð¾": {"kz": "ÐžÒ›Ð°ÑÑ‹ Ð¶Ð¾Ò›! ðŸ˜Š", "ru": "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°! ÐžÐ±Ñ€Ð°Ñ‰Ð°Ð¹Ñ‚ÐµÑÑŒ ÐµÑ‰Ñ‘! ðŸ˜Š", "en": "You're welcome! ðŸ˜Š"},
    "thanks": {"kz": "ÐžÒ›Ð°ÑÑ‹ Ð¶Ð¾Ò›! ðŸ˜Š", "ru": "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°! ðŸ˜Š", "en": "You're welcome! Feel free to ask more! ðŸ˜Š"},
    "thank you": {"kz": "ÐžÒ›Ð°ÑÑ‹ Ð¶Ð¾Ò›! ðŸ˜Š", "ru": "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°! ðŸ˜Š", "en": "You're welcome! ðŸ˜Š"},
    "ÐºÓ©Ð¼ÐµÐº": {"kz": "ÐœÐµÐ½ ÑÑ–Ð·Ð³Ðµ ÐºÓ©Ð¼ÐµÐºÑ‚ÐµÑÑƒÐ³Ðµ Ð´Ð°Ð¹Ñ‹Ð½Ð¼Ñ‹Ð½! ÒšÐ°Ð½Ð´Ð°Ð¹ ÑÒ±Ñ€Ð°Ò“Ñ‹Ò£Ñ‹Ð· Ð±Ð°Ñ€?", "ru": "Ð¯ Ð³Ð¾Ñ‚Ð¾Ð² Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ! ÐšÐ°ÐºÐ¾Ð¹ Ñƒ Ð²Ð°Ñ Ð²Ð¾Ð¿Ñ€Ð¾Ñ?", "en": "I'm ready to help! What's your question?"},
    "help": {"kz": "ÐœÐµÐ½ ÐºÓ©Ð¼ÐµÐºÑ‚ÐµÑÑƒÐ³Ðµ Ð´Ð°Ð¹Ñ‹Ð½Ð¼Ñ‹Ð½!", "ru": "Ð¯ Ð³Ð¾Ñ‚Ð¾Ð² Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ!", "en": "I'm ready to help! What's your question?"},
    "Ð¿Ñ€Ð¸Ð²ÐµÑ‚": {"kz": "Ð¡Ó™Ð»ÐµÐ¼ÐµÑ‚ÑÑ–Ð· Ð±Ðµ! ÐœÐµÐ½ CyberQalqan AI-Ð¼Ñ‹Ð½. Ð¡Ñ–Ð·Ð³Ðµ Ò›Ð°Ð½Ð´Ð°Ð¹ ÐºÓ©Ð¼ÐµÐº ÐºÐµÑ€ÐµÐº?", "ru": "Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ! Ð¯ CyberQalqan AI. Ð§ÐµÐ¼ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?", "en": "Hello! I am CyberQalqan AI. How can I help you?"},
    "ÑÓ™Ð»ÐµÐ¼": {"kz": "Ð¡Ó™Ð»ÐµÐ¼ÐµÑ‚ÑÑ–Ð· Ð±Ðµ! ÐœÐµÐ½ CyberQalqan AI-Ð¼Ñ‹Ð½. Ð¡Ñ–Ð·Ð³Ðµ Ò›Ð°Ð½Ð´Ð°Ð¹ ÐºÓ©Ð¼ÐµÐº ÐºÐµÑ€ÐµÐº?", "ru": "Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ! Ð¯ CyberQalqan AI. Ð§ÐµÐ¼ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?", "en": "Hello! I am CyberQalqan AI. How can I help you?"},
    "hello": {"kz": "Ð¡Ó™Ð»ÐµÐ¼ÐµÑ‚ÑÑ–Ð· Ð±Ðµ! ÐœÐµÐ½ CyberQalqan AI-Ð¼Ñ‹Ð½. Ð¡Ñ–Ð·Ð³Ðµ Ò›Ð°Ð½Ð´Ð°Ð¹ ÐºÓ©Ð¼ÐµÐº ÐºÐµÑ€ÐµÐº?", "ru": "Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ! Ð¯ CyberQalqan AI. Ð§ÐµÐ¼ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?", "en": "Hello! I am CyberQalqan AI. How can I help you?"},
}


from g4f.client import Client

def get_chat_response(message: str) -> Dict[str, any]:
    """Get a chat response for the given message using g4f (LLM)."""
    msg_lower = message.lower().strip()

    # Check quick responses first to save time and API calls
    for key, response in QUICK_RESPONSES.items():
        if key in msg_lower:
            return {
                "answer": response,
                "source": "CyberQalqan AI (Quick Response)",
            }

    try:
        # Call the g4f LLM provider via the new Client interface
        client = Client()
        response = client.chat.completions.create(
            model="gpt-4o-mini",
            messages=[
                {"role": "system", "content": SYSTEM_PROMPT},
                {"role": "user", "content": message},
            ]
        )
        
        # Get the text content from the response
        response_text = response.choices[0].message.content
        
        # Clean up ads that some free g4f providers return
        ad_markers = [
            "Need proxies cheaper than the market?", 
            "https://op.wtf"
        ]
        for marker in ad_markers:
            if marker in response_text:
                response_text = response_text.split(marker)[0].strip()
        
        # Determine language vaguely based on input (fallback for JSON frontend if it requires a dict)
        if isinstance(response_text, str):
             answer_dict = {
                 "kz": response_text,
                 "ru": response_text,
                 "en": response_text
             }
        else:
             answer_dict = {
                 "kz": str(response_text),
                 "ru": str(response_text),
                 "en": str(response_text)
             }

        return {
            "answer": answer_dict,
            "source": "CyberQalqan LLM (g4f)",
        }
        
    except Exception as e:
        print(f"g4f Error: {e}")
        # Fallback if g4f fails (e.g. rate limit, no internet)
        fallback_msg = "ÐšÐµÑˆÑ–Ñ€Ñ–Ò£Ñ–Ð·, Ò›Ð°Ð·Ñ–Ñ€ Ð¼ÐµÐ½Ñ–Ò£ ÑÐµÑ€Ð²ÐµÑ€Ñ–Ð¼Ð´Ðµ Ð¶Ò¯ÐºÑ‚ÐµÐ¼Ðµ ÐºÓ©Ð¿ (LLM Error). ÐšÑ–ÑˆÐºÐµÐ½Ðµ ÐºÒ¯Ñ‚Ðµ Ñ‚Ò±Ñ€Ñ‹Ò£Ñ‹Ð·. / Ð˜Ð·Ð²Ð¸Ð½Ð¸Ñ‚Ðµ, ÑÐµÐ¹Ñ‡Ð°Ñ Ð±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°. ÐŸÐ¾Ð´Ð¾Ð¶Ð´Ð¸Ñ‚Ðµ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾."
        return {
            "answer": {
                "kz": fallback_msg,
                "ru": fallback_msg,
                "en": fallback_msg
            },
            "source": "CyberQalqan System Error"
        }


# Suggested questions for the chat UI
SUGGESTED_QUESTIONS = [
    {"kz": "Instagram Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ñ‹Ð¼Ð´Ñ‹ Ò›Ð°Ð»Ð°Ð¹ Ò›Ð¾Ñ€Ò“Ð°Ð¹Ð¼Ñ‹Ð½?", "icon": "ðŸ“¸"},
    {"kz": "Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½Ñ‹Ð¼ Ð±Ò±Ð·Ñ‹Ð»Ð´Ñ‹ Ð¼Ð°?", "icon": "ðŸ“±"},
    {"kz": "Ð¤Ð¸ÑˆÐ¸Ð½Ð³ Ð´ÐµÐ³ÐµÐ½ Ð½Ðµ?", "icon": "ðŸŽ£"},
    {"kz": "Ð¡ÐµÐ½Ñ–Ð¼Ð´Ñ– Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ò›Ð°Ð»Ð°Ð¹ Ð¶Ð°ÑÐ°Ð¹Ð¼Ñ‹Ð½?", "icon": "ðŸ”"},
    {"kz": "Wi-Fi Ò›Ð°ÑƒÑ–Ð¿ÑÑ–Ð·Ð´Ñ–Ð³Ñ–", "icon": "ðŸ“¶"},
    {"kz": "Ð‘Ò±Ð» ÑÐ°Ð¹Ñ‚ Ò›Ð°ÑƒÑ–Ð¿ÑÑ–Ð· Ð±Ðµ?", "icon": "ðŸŒ"},
    {"kz": "VPN Ð´ÐµÐ³ÐµÐ½ Ð½Ðµ?", "icon": "ðŸŒ"},
    {"kz": "2FA Ð´ÐµÐ³ÐµÐ½ Ð½Ðµ?", "icon": "ðŸ”’"},
]

def analyze_call_transcript(transcript: str) -> Dict[str, Any]:
    """Analyze a transcribed phone call or voice message for vishing/scams."""
    
    analysis_prompt = f"""
Ð¢Ñ‹ â€” CyberQalqan AI, ÑÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ ÐºÐ¸Ð±ÐµÑ€Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸.
ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¿ÐµÑ€ÐµÑÐ»Ð°Ð» Ñ‚ÐµÐ±Ðµ Ð¿Ð¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¸Ð»Ð¸ Ð¿Ð¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€ Ð¿Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ (Ñ‚Ñ€Ð°Ð½ÑÐºÑ€Ð¸Ð¿Ñ†Ð¸Ñ Ð½Ð¸Ð¶Ðµ).
Ð¢Ð²Ð¾Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ, ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð»Ð¸ ÑÑ‚Ð¾ ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼ Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾Ð¼ (Ð’Ð¸ÑˆÐ¸Ð½Ð³Ð¾Ð¼), ÑÐ¾Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ð¶ÐµÐ½ÐµÑ€Ð¸ÐµÐ¹, Ð¸Ð»Ð¸ Ð·Ð²Ð¾Ð½ÐºÐ¾Ð¼ Ð¾Ñ‚ Ð½ÐµÐ½Ð°ÑÑ‚Ð¾ÑÑ‰ÐµÐ³Ð¾ "ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° Ð±Ð°Ð½ÐºÐ°" / "Ñ€Ð¾Ð´ÑÑ‚Ð²ÐµÐ½Ð½Ð¸ÐºÐ° Ð² Ð±ÐµÐ´Ðµ".

ÐŸÑ€Ð°Ð²Ð¸Ð»Ð° Ð¾Ñ‚Ð²ÐµÑ‚Ð°:
1. Ð•ÑÐ»Ð¸ ÑÑ‚Ð¾ Ð¿Ð¾Ñ…Ð¾Ð¶Ðµ Ð½Ð° Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾:
ÐÐ°Ñ‡Ð½Ð¸ Ð¾Ñ‚Ð²ÐµÑ‚ ÑÐ¾ ÑÐ»Ð¾Ð²: "ðŸš¨ Ð‘Ò±Ð» Ð¿ÑÐ¸Ñ…Ð¾Ð»Ð¾Ð³Ð¸ÑÐ»Ñ‹Ò› Ð¼Ð°Ð½Ð¸Ð¿ÑƒÐ»ÑÑ†Ð¸Ñ Ð¶Ó™Ð½Ðµ ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸ÐºÐ°Ð»Ñ‹Ò› Ð°Ð»Ð°ÑÒ›Ñ‚Ñ‹Ò› (Ð’Ð¸ÑˆÐ¸Ð½Ð³). Ð‘Ð°Ð½Ðº Ò›Ñ‹Ð·Ð¼ÐµÑ‚ÐºÐµÑ€Ð»ÐµÑ€Ñ– ÐµÑˆÒ›Ð°ÑˆÐ°Ð½ Ð¡ÐœÐ¡-ÐºÐ¾Ð´ ÑÒ±Ñ€Ð°Ð¼Ð°Ð¹Ð´Ñ‹." (ÐÐ° ÐºÐ°Ð·Ð°Ñ…ÑÐºÐ¾Ð¼), "ðŸš¨ Ð­Ñ‚Ð¾ Ð¿ÑÐ¸Ñ…Ð¾Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¼Ð°Ð½Ð¸Ð¿ÑƒÐ»ÑÑ†Ð¸Ñ Ð¸ ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ (Ð’Ð¸ÑˆÐ¸Ð½Ð³). Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¸ Ð±Ð°Ð½ÐºÐ° Ð¸Ð»Ð¸ Ð¿Ð¾Ð»Ð¸Ñ†Ð¸Ð¸ Ð½Ð¸ÐºÐ¾Ð³Ð´Ð° Ð¿Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ Ð½Ðµ Ð¿Ñ€Ð¾ÑÑÑ‚ Ð¡ÐœÐ¡-ÐºÐ¾Ð´Ñ‹, Ð½Ðµ Ð¿Ñ€Ð¾ÑÑÑ‚ Ð¿ÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ Ð´ÐµÐ½ÑŒÐ³Ð¸ Ð½Ð° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚ Ð¸ Ð½Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ ÑÐºÐ°Ñ‡Ð¸Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ." (ÐÐ° Ñ€ÑƒÑÑÐºÐ¾Ð¼).
Ð”Ð°Ð»ÐµÐµ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾ Ð¾Ð±ÑŠÑÑÐ½Ð¸, Ð² Ñ‡ÐµÐ¼ Ð¸Ð¼ÐµÐ½Ð½Ð¾ ÑƒÐ»Ð¾Ð²ÐºÐ° Ð¾Ð±Ð¼Ð°Ð½Ñ‰Ð¸ÐºÐ¾Ð² Ð² ÑÑ‚Ð¾Ð¼ Ñ‚ÐµÐºÑÑ‚Ðµ.

2. Ð•ÑÐ»Ð¸ Ñ‚ÐµÐºÑÑ‚ Ð½Ðµ Ð¿Ð¾Ñ…Ð¾Ð¶ Ð½Ð° Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ (Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€ Ð¸Ð»Ð¸ Ð½ÐµÑÑÐ½Ñ‹Ð¹ ÑˆÑƒÐ¼):
ÐžÑ‚Ð²ÐµÑ‚ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾: "âœ… Ð‘Ò±Ð» Ò›Ð°Ñ€Ð°Ð¿Ð°Ð¹Ñ‹Ð¼ Ñ…Ð°Ð±Ð°Ñ€Ð»Ð°Ð¼Ð° ÑÐ¸ÑÒ›Ñ‚Ñ‹. Ð‘Ñ–Ñ€Ð°Ò› Ó™Ñ€Ò›Ð°ÑˆÐ°Ð½ ÑÐ°Ò› Ð±Ð¾Ð»Ñ‹Ò£Ñ‹Ð·!" (ÐÐ° ÐºÐ°Ð·Ð°Ñ…ÑÐºÐ¾Ð¼), "âœ… Ð­Ñ‚Ð¾ Ð¿Ð¾Ñ…Ð¾Ð¶Ðµ Ð½Ð° Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ. ÐÐ¾ Ð²ÑÐµÐ³Ð´Ð° Ð±ÑƒÐ´ÑŒÑ‚Ðµ Ð±Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹!" (ÐÐ° Ñ€ÑƒÑÑÐºÐ¾Ð¼).

ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ ÑÑ€Ð°Ð·Ñƒ Ð½Ð° Ð´Ð²ÑƒÑ… ÑÐ·Ñ‹ÐºÐ°Ñ… Ñ‡ÐµÑ€ÐµÐ· Ð°Ð±Ð·Ð°Ñ†: ÑÐ½Ð°Ñ‡Ð°Ð»Ð° Ð½Ð° ÐºÐ°Ð·Ð°Ñ…ÑÐºÐ¾Ð¼, Ð·Ð°Ñ‚ÐµÐ¼ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼.

Ð¢Ñ€Ð°Ð½ÑÐºÑ€Ð¸Ð¿Ñ†Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ°/ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ:
"{transcript}"
"""
    try:
        from g4f.client import Client
        client = Client()
        response = client.chat.completions.create(
            model="gpt-4o-mini",
            messages=[
                {"role": "user", "content": analysis_prompt},
            ]
        )
        response_text = response.choices[0].message.content
        
        ad_markers = [
            "Need proxies cheaper than the market?", 
            "https://op.wtf"
        ]
        for marker in ad_markers:
            if marker in response_text:
                response_text = response_text.split(marker)[0].strip()
                
        answer_dict = {
            "kz": str(response_text),
            "ru": str(response_text),
            "en": str(response_text)
        }
        
        return {
            "answer": answer_dict,
            "source": "CyberQalqan LLM (Voice Analysis)",
        }
    except Exception as e:
        print(f"Voice Analysis LLM Error: {e}")
        fallback = "âš ï¸ ÐšÐµÑˆÑ–Ñ€Ñ–Ò£Ñ–Ð·, Ð´Ð°ÑƒÑ‹ÑÑ‚Ñ‹Ò› Ñ…Ð°Ð±Ð°Ñ€Ð»Ð°Ð¼Ð°Ð½Ñ‹ ÑÐ°Ñ€Ð°Ð¿Ñ‚Ð°Ñƒ Ð¼Ò¯Ð¼ÐºÑ–Ð½ Ð±Ð¾Ð»Ð¼Ð°Ð´Ñ‹. Ð‘Ò±Ð» Ð°Ð»Ð°ÑÒ›Ñ‚Ñ‹Ò› Ð±Ð¾Ð»ÑƒÑ‹ Ó™Ð±Ð´ÐµÐ½ Ð¼Ò¯Ð¼ÐºÑ–Ð½, ÐµÑˆÐºÑ–Ð¼Ð³Ðµ Ð¡ÐœÐ¡ ÐºÐ¾Ð´ Ð½ÐµÐ¼ÐµÑÐµ Ð°Ò›ÑˆÐ° Ð¶Ñ–Ð±ÐµÑ€Ð¼ÐµÒ£Ñ–Ð·!"
        return {
            "answer": {
                "kz": fallback,
                "ru": fallback,
                "en": fallback
            },
            "source": "CyberQalqan System Error"
        }

def analyze_image_text(ocr_text: str) -> Dict[str, Any]:
    """Analyze text extracted from an image (OCR) for scam indicators."""
    
    if not ocr_text or len(ocr_text.strip()) < 5:
         fallback = "ðŸ–¼ï¸ Ð¡ÑƒÑ€ÐµÑ‚Ñ‚ÐµÐ³Ñ– Ð¼Ó™Ñ‚Ñ–Ð½ Ó©Ñ‚Ðµ Ð°Ð· Ð½ÐµÐ¼ÐµÑÐµ Ð¾Ò›Ñ‹Ð»Ð¼Ð°Ð´Ñ‹. Ð•Ð³ÐµÑ€ Ð±Ò±Ð» Ñ‡ÐµÐº Ð±Ð¾Ð»ÑÐ°, Ð¾Ð½Ñ‹Ò£ Ñ‚Ò¯Ð¿Ð½Ò±ÑÒ›Ð°Ð»Ñ‹Ò“Ñ‹Ð½ Ñ‚ÐµÐºÑÐµÑ€Ñ–Ò£Ñ–Ð·. / Ð¢ÐµÐºÑÑ‚ Ð½Ð° Ñ„Ð¾Ñ‚Ð¾ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹ Ð¸Ð»Ð¸ Ð½Ðµ Ñ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ. Ð•ÑÐ»Ð¸ ÑÑ‚Ð¾ Ñ‡ÐµÐº, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÐµÐ³Ð¾ Ð¿Ð¾Ð´Ð»Ð¸Ð½Ð½Ð¾ÑÑ‚ÑŒ."
         return {
             "answer": {
                 "kz": fallback,
                 "ru": fallback,
                 "en": fallback
             },
             "source": "CyberQalqan OCR Check"
         }

    analysis_prompt = f"""
Ð¢Ñ‹ â€” CyberQalqan AI, ÑÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ ÐºÐ¸Ð±ÐµÑ€Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸.
ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¿Ñ€Ð¸ÑÐ»Ð°Ð» ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚ Ð¸Ð»Ð¸ Ñ„Ð¾Ñ‚Ð¾ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ¸Ð¹ Ñ‡ÐµÐº, ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ñ‚ Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸ÐºÐ¾Ð² Ð² WhatsApp, Ñ€ÐµÐºÐ»Ð°Ð¼Ð° Ð²Ñ‹Ð¸Ð³Ñ€Ñ‹ÑˆÐ°). Ð¯ Ð¸Ð·Ð²Ð»ÐµÐº Ð¸Ð· Ð½ÐµÐ³Ð¾ ÑÑ‚Ð¾Ñ‚ Ñ‚ÐµÐºÑÑ‚ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ OCR (Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¸Ðµ Ð¾Ð¿ÐµÑ‡Ð°Ñ‚ÐºÐ¸ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ).

Ð¢Ð²Ð¾Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ, ÐµÑÑ‚ÑŒ Ð»Ð¸ Ð² ÑÑ‚Ð¾Ð¼ Ñ‚ÐµÐºÑÑ‚Ðµ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¸ Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° (Ð¿Ð¾Ð´Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ñ‡ÐµÐº Ð¾Ð± Ð¾Ð¿Ð»Ð°Ñ‚Ðµ Kaspi/Halyk, ÑÐ¾Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ð¸Ð½Ð¶ÐµÐ½ÐµÑ€Ð¸Ñ, ÑƒÐ³Ñ€Ð¾Ð·Ñ‹, Ð¾Ð±ÐµÑ‰Ð°Ð½Ð¸Ðµ Ð»ÐµÐ³ÐºÐ¸Ñ… Ð´ÐµÐ½ÐµÐ³, Ð»Ð¾Ñ‚ÐµÑ€ÐµÑ).

ÐŸÑ€Ð°Ð²Ð¸Ð»Ð° Ð¾Ñ‚Ð²ÐµÑ‚Ð°:
1. Ð•ÑÐ»Ð¸ Ñ‚ÐµÐºÑÑ‚ ÑÐ²Ð½Ð¾ Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¸Ð»Ð¸ Ð¿Ð¾Ñ…Ð¾Ð¶ Ð½Ð° Ñ„ÐµÐ¹ÐºÐ¾Ð²Ñ‹Ð¹ Ñ‡ÐµÐº/ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð°:
ÐÐ°Ñ‡Ð½Ð¸ Ð¾Ñ‚Ð²ÐµÑ‚: "ðŸš¨ ÐÐ°Ð·Ð°Ñ€ Ð°ÑƒÐ´Ð°Ñ€Ñ‹Ò£Ñ‹Ð·! Ð¡ÑƒÑ€ÐµÑ‚Ñ‚ÐµÐ³Ñ– Ð¼Ó™Ñ‚Ñ–Ð½Ð½ÐµÐ½ Ð°Ð»Ð°ÑÒ›Ñ‚Ñ‹Ò› Ð±ÐµÐ»Ð³Ñ–Ð»ÐµÑ€Ñ– Ð±Ð°Ð¹Ò›Ð°Ð»Ð´Ñ‹." (ÐÐ° ÐºÐ°Ð·Ð°Ñ…ÑÐºÐ¾Ð¼), "ðŸš¨ Ð’Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ! Ð’ Ñ‚ÐµÐºÑÑ‚Ðµ Ð½Ð° Ñ„Ð¾Ñ‚Ð¾ ÐµÑÑ‚ÑŒ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¸ Ð¼Ð¾ÑˆÐµÐ½Ð½Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ð¸Ð»Ð¸ Ð¿Ð¾Ð´Ð´ÐµÐ»ÐºÐ¸." (ÐÐ° Ñ€ÑƒÑÑÐºÐ¾Ð¼).
Ð”Ð°Ð»ÐµÐµ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾ Ð¾Ð±ÑŠÑÑÐ½Ð¸, Ñ‡Ñ‚Ð¾ Ð½Ðµ Ñ‚Ð°Ðº: Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, "Ð¡Ð°Ð¼ Ñ„Ð°ÐºÑ‚ ÑÐºÑ€Ð¸Ð½Ð° Ñ‡ÐµÐºÐ° Ð½Ðµ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ Ð¾Ð¿Ð»Ð°Ñ‚Ñƒ, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐ¹Ñ‚Ðµ Ð¿Ð¾ÑÑ‚ÑƒÐ¿Ð»ÐµÐ½Ð¸Ðµ Ñƒ ÑÐµÐ±Ñ Ð² Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¸" Ð¸Ð»Ð¸ "Ð­Ñ‚Ð¾ Ñ‚Ð¸Ð¿Ð¸Ñ‡Ð½Ð°Ñ ÑÑ…ÐµÐ¼Ð° Ñ 'Ð²Ñ‹Ð¸Ð³Ñ€Ñ‹ÑˆÐµÐ¼'".

2. Ð•ÑÐ»Ð¸ Ñ‚ÐµÐºÑÑ‚ Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ Ð¸Ð»Ð¸ ÑÑ‚Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚/Ð¼ÐµÐ¼ Ð±ÐµÐ· ÑƒÐ³Ñ€Ð¾Ð·Ñ‹:
ÐžÑ‚Ð²ÐµÑ‚ÑŒ: "âœ… Ð¡ÑƒÑ€ÐµÑ‚Ñ‚ÐµÐ³Ñ– Ð¼Ó™Ñ‚Ñ–Ð½ Ò›Ð°ÑƒÑ–Ð¿ÑÑ–Ð· ÑÐ¸ÑÒ›Ñ‚Ñ‹. Ð‘Ñ–Ñ€Ð°Ò› Ñ‡ÐµÐº Ð±Ð¾Ð»ÑÐ°, Ð°Ò›ÑˆÐ°Ð½Ñ‹Ò£ Ñ‚Ò¯ÑÐºÐµÐ½Ñ–Ð½ Ó©Ð· Ò›Ð¾ÑÑ‹Ð¼ÑˆÐ°Ò£Ñ‹Ð·Ð´Ð°Ð½ Ñ‚ÐµÐºÑÐµÑ€Ñ–Ò£Ñ–Ð·." (ÐÐ° ÐºÐ°Ð·Ð°Ñ…ÑÐºÐ¾Ð¼), "âœ… Ð¢ÐµÐºÑÑ‚ Ð½Ð° Ñ„Ð¾Ñ‚Ð¾ Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾. ÐÐ¾ ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ Ñ‡ÐµÐº Ð¾Ð± Ð¾Ð¿Ð»Ð°Ñ‚Ðµ, Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð±Ð°Ð»Ð°Ð½Ñ Ð² Ð²Ð°ÑˆÐµÐ¼ Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ¾Ð¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¸." (ÐÐ° Ñ€ÑƒÑÑÐºÐ¾Ð¼).

ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ ÑÑ€Ð°Ð·Ñƒ Ð½Ð° Ð´Ð²ÑƒÑ… ÑÐ·Ñ‹ÐºÐ°Ñ… Ñ‡ÐµÑ€ÐµÐ· Ð°Ð±Ð·Ð°Ñ†: ÑÐ½Ð°Ñ‡Ð°Ð»Ð° Ð½Ð° ÐºÐ°Ð·Ð°Ñ…ÑÐºÐ¾Ð¼, Ð·Ð°Ñ‚ÐµÐ¼ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼.

Ð Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð½Ð½Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚ Ñ ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐ¸:
"{ocr_text}"
"""
    try:
        from g4f.client import Client
        client = Client()
        response = client.chat.completions.create(
            model="gpt-4o-mini",
            messages=[
                {"role": "user", "content": analysis_prompt},
            ]
        )
        response_text = response.choices[0].message.content
        
        ad_markers = [
            "Need proxies cheaper than the market?", 
            "https://op.wtf"
        ]
        for marker in ad_markers:
            if marker in response_text:
                response_text = response_text.split(marker)[0].strip()
                
        answer_dict = {
            "kz": str(response_text),
            "ru": str(response_text),
            "en": str(response_text)
        }
        
        return {
            "answer": answer_dict,
            "source": "CyberQalqan LLM (Image OCR Analysis)",
        }
    except Exception as e:
        print(f"Image Analysis LLM Error: {e}")
        fallback = "âš ï¸ ÐšÐµÑˆÑ–Ñ€Ñ–Ò£Ñ–Ð·, ÑÑƒÑ€ÐµÑ‚Ñ‚ÐµÐ³Ñ– Ð¼Ó™Ñ‚Ñ–Ð½Ð´Ñ– ÑÐ°Ñ€Ð°Ð¿Ñ‚Ð°ÑƒÐ´Ð° Ò›Ð°Ñ‚Ðµ ÑˆÑ‹Ò›Ñ‚Ñ‹. ÐšÒ¯Ð¼Ó™Ð½Ð´Ð°Ð½ÑÐ°Ò£Ñ‹Ð·, ÐµÑˆÐºÑ–Ð¼Ð³Ðµ Ð°Ò›ÑˆÐ° Ð°ÑƒÐ´Ð°Ñ€Ð¼Ð°Ò£Ñ‹Ð·. / ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ðµ Ñ‚ÐµÐºÑÑ‚Ð° Ñ Ñ„Ð¾Ñ‚Ð¾. ÐŸÑ€Ð¸ ÑÐ¾Ð¼Ð½ÐµÐ½Ð¸ÑÑ… Ð½Ðµ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð¸Ñ‚Ðµ Ð½Ð¸ÐºÐ¾Ð¼Ñƒ Ð´ÐµÐ½ÑŒÐ³Ð¸."
        return {
            "answer": {
                "kz": fallback,
                "ru": fallback,
                "en": fallback
            },
            "source": "CyberQalqan System Error"
        }

